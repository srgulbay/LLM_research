{% extends "admin/admin_layout_new.html" %}
{% block title %}Bilimsel Analiz: {{ research.title }}{% endblock %}

{% block admin_content %}
<div class="mb-8">
    <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Bilimsel Analiz Paneli</h2>
    <p class="text-slate-500 dark:text-slate-400 mt-1">{{ research.title }}</p>
</div>

<div class="bg-white dark:bg-slate-800 p-6 rounded-xl shadow-lg mb-8">
    <h3 class="text-lg font-bold text-slate-900 dark:text-white mb-4">Genel Performans: İnsan vs. LLM (Ortalama Skor)</h3>
    <canvas id="overallPerformanceChart"></canvas>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <div class="bg-white dark:bg-slate-800 p-6 rounded-xl shadow-lg">
        <h3 class="text-lg font-bold text-slate-900 dark:text-white mb-4">Katılımcı Performansı (Unvana Göre)</h3>
        <canvas id="performanceByProfessionChart"></canvas>
    </div>
    <div class="bg-white dark:bg-slate-800 p-6 rounded-xl shadow-lg">
        <h3 class="text-lg font-bold text-slate-900 dark:text-white mb-4">Önemli Bulgular</h3>
        <div class="space-y-4">
            <div class="bg-slate-100 dark:bg-slate-700 p-4 rounded-lg">
                <p class="text-sm text-slate-500 dark:text-slate-400">Güven & Performans Korelasyonu</p>
                <p class="text-2xl font-bold text-slate-900 dark:text-white">{{ analytics.confidence_correlation or 'Hesaplanamadı' }}</p>
                <p class="text-xs text-slate-400 dark:text-slate-500 mt-1">1'e yakın değerler, kendine güvenenlerin daha başarılı olduğunu gösterir.</p>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const analytics = {{ analytics | tojson }};

    // Genel Performans Grafiği
    new Chart(document.getElementById('overallPerformanceChart'), {
        type: 'bar',
        data: {
            labels: analytics.overall_performance.labels,
            datasets: [{
                label: 'Ortalama Skor (100 üzerinden)',
                data: analytics.overall_performance.data,
                backgroundColor: analytics.overall_performance.labels.map(label => label.includes('İnsan') ? '#3B82F6' : '#6B7280'),
            }]
        }
    });

    // Unvanlara Göre Performans Grafiği
    new Chart(document.getElementById('performanceByProfessionChart'), {
        type: 'bar',
        data: {
            labels: analytics.performance_by_profession.labels,
            datasets: [{
                label: 'Ortalama Skor',
                data: analytics.performance_by_profession.data,
                backgroundColor: '#10B981',
            }]
        },
        options: { indexAxis: 'y' }
    });
</script>
{% endblock %}