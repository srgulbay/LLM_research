{% extends "layout_new.html" %}

{% block title %}Final Raporu: {{ research.title }}{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <div class="text-center mb-10">
        <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Araştırmayı Tamamladınız!</h2>
        <p class="text-slate-500 dark:text-slate-400 mt-2 text-lg">
            <strong>"{{ research.title }}"</strong> başlıklı araştırmaya katılımınız için çok teşekkür ederiz.<br>
            İşte yanıtlarınızın altın standart ve yapay zeka modelleriyle karşılaştırması:
        </p>
    </div>

    <div class="space-y-8">
        {% for response in responses %}
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg overflow-hidden">
            <div class="p-6 border-b border-slate-200 dark:border-slate-700">
                <h3 class="text-xl font-bold text-slate-900 dark:text-white">Vaka: {{ response.case.content.title }}</h3>
            </div>
            <div class="divide-y divide-slate-200 dark:divide-slate-700">
                {% for q in response.case.content.questions %}
                    {% set question_id = q.id %}
                    <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="md:col-span-1"><p class="font-semibold text-slate-800 dark:text-slate-200">{{ q.label }}</p></div>
                        <div class="md:col-span-2 space-y-3">
                            <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 p-3 rounded-lg">
                                <p class="text-xs font-bold text-blue-800 dark:text-blue-400 uppercase mb-1">Sizin Yanıtınız</p>
                                <p class="text-blue-900 dark:text-blue-100">{{ response.answers.get(question_id, 'Yanıt verilmemiş') }}</p>
                            </div>
                            <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 p-3 rounded-lg">
                                <p class="text-xs font-bold text-green-800 dark:text-green-400 uppercase mb-1">Altın Standart</p>
                                {% if response.case.content and response.case.content.gold_standard %}
                                    <p class="text-green-900 dark:text-green-100 font-semibold">
                                        {{ response.case.content.gold_standard.get(question_id, 'N/A') }}
                                    </p>
                                {% else %}
                                    <p class="text-slate-500 dark:text-slate-400">Altın standart verisi mevcut değil</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="text-center mt-10">
        <a href="{{ url_for('select_research') }}" class="inline-block bg-slate-800 dark:bg-slate-700 text-white font-bold py-3 px-6 rounded-lg hover:bg-slate-900 dark:hover:bg-slate-600 transition-colors">
            Diğer Araştırmalara Göz At
        </a>
    </div>
</div>
{% endblock %}